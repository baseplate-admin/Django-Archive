{% load soundcore_tags %}
<style>
    .left-menu {
        background-color: #161616;
        height: 100vh;
    }

    .icon_box {
        width: 240px;
        background-color: transparent;
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
        height: 10px;
        border-radius: 0;
    }

    .icon_box_column {
        transform: translateY(-12px);
    }

    .icon_box:hover {
        background-color: #404040;
    }

    .icons {
        border-bottom: 1px solid #313131;
        padding-bottom: .5em;
    }

    .icon_text {
        color: #e0e0ec
    }

    .is_icon_active {
        background-color: #242424;
    }

    .playlist-wrapper {
        padding-top: .5em
    }

    .add-icon-box {
        height: 25px;
        width: 25px;
        background-color: transparent;
        transform: translateY(-5px);
        border: 1px solid white;
        border-radius: 8px;
    }

    .add-icon-wrapper {
        display: flex;
        justify-content: center;
        padding: .5em;
        transform: translateX(-25px);
    }
</style>

{% if class == 'is_footer_active' %}
    <aside class="menu left-menu is_footer_active">
{% else %}
    <aside class="menu left-menu">
{% endif %}
<div class="icons">
    <a href="{% url 'home' %}">
        {% if active == 'home' %}

            <div class="box icon_box is_icon_active">

        {% else %}

            <div class="box icon_box">

        {% endif %}
        <div class="columns is-mobile icon_box_column">
            <div class="column is-2 is-offset-1">
                <ion-icon class="home__icon" name="home-outline"></ion-icon>
                <script async>
                    anime({
                        targets: '.home__icon',
                        color: '#FFFFFF',
                        scale: 1.4
                    })
                </script>
            </div>

            <div class="column icon_text">
                Home
            </div>
        </div>
        </div>
    </a>

    <a href="{% url 'library_home' %}">
        {% if active == 'library' %}
            <div class="box icon_box is_icon_active">
        {% else %}
            <div class="box icon_box">
        {% endif %}

        <div class="columns is-mobile icon_box_column">
            <div class="column is-2 is-offset-1">
                <ion-icon class="library__icon" name="library-outline"></ion-icon>
                <script async>
                    anime({
                        targets: '.library__icon',
                        color: '#FFFFFF',
                        scale: 1.4,
                    })
                </script>
            </div>
            <div class="column icon_text">
                Library
            </div>
        </div>
        </div>
    </a>

</div>
<div class="playlist-wrapper">
    <div class="playlist-add">
        <div class="columns is-centered">
            <div class="column">
                <a href="{% url 'library_generator' %}" class="add-icon-wrapper">
                    <div class="add-icon-box">
                        <ion-icon class="add__icon" name="add-outline"></ion-icon>
                    </div>

                </a>
                <script>
                    anime({
                        targets: '.add__icon',
                        color: '#FFFFFF',
                        easing: 'linear',
                        duration: 0,
                        scale: 1.3,
                        translateX: 3,
                    })
                </script>
            </div>
        </div>
    </div>
    {% get_total_playlist %}
</div>
</aside>

<script>
    const hamburgerElement = document.getElementById('hamburger_icon_wrapper_id')
    const leftMenuElement = document.getElementsByClassName('left-menu')[0]
    {% comment %}

        left-menu-hidden = Sidebar is hidden
        !left-menu-hidden = Sidebar is shown

     {% endcomment %}

    hamburgerElement.addEventListener('click', () => {
        {% comment %}
            This statement checks if classlist contains Left-Menu-Hidden.
            Then if it doesn't have the class.
            AnimeJS resizes the Menu to previous Size and removes the left-menu-hidden.
         {% endcomment %}
        {# Open #}
        if (leftMenuElement.classList.contains('left-menu-hidden')) {
            anime({
                targets: '.left-menu',
                translateX: 0,
                duration: 500,
                easing: 'easeOutSine',
                complete: () => {
                    leftMenuElement.classList.remove('left-menu-hidden')
                }
            })
            anime({
                targets: '.left-menu',
                width: '240',
                duration: 400,
                easing: 'easeOutSine',
            })

        }

            {% comment %}
                This statement checks if classlist contains Left-Menu-Hidden.
                This it does have the class.
                AnimeJS removes the left menu and adds the class in a callback.
             {% endcomment %}
            {# Close #}
        else if (!leftMenuElement.classList.contains('left-menu-hidden')) {
            anime({
                targets: '.left-menu',
                translateX: -500,
                duration: 500,
                easing: 'easeOutSine',
                complete: () => {
                    leftMenuElement.classList.add('left-menu-hidden')
                }
            })
            anime({
                targets: '.left-menu',
                width: '0',
                duration: 400,
                easing: 'easeOutSine',
            })
        }
    })
</script>
<script async>
    let mediaQueryListener = window.matchMedia('(max-width: 767px)')

    const watchMediaQueryFunction = (event) => {
        if (event.matches) {
            {# Mobile Version #}
            anime({
                targets: '.left-menu',
                translateX: -500,
                duration: .001,
                easing: 'easeOutSine',
                complete: () => {
                    leftMenuElement.classList.add('left-menu-hidden')
                }
            })
            anime({
                targets: '.left-menu',
                width: '0',
                duration: .0001,
                easing: 'easeOutSine',
            })
        } else if (!event.matches) {
            {# Desktop Vesion #}
            leftMenuElement.classList.remove('left-menu-hidden')
            anime({
                targets: '.left-menu',
                translateX: 0,
                duration: .001,
                easing: 'easeOutSine',
                complete: () => {
                    leftMenuElement.classList.remove('left-menu-hidden')
                }
            })
            anime({
                targets: '.left-menu',
                width: '240',
                duration: .0001,
                easing: 'easeOutSine',
            })
        }
    }
    // Init the Function Once
    watchMediaQueryFunction(mediaQueryListener)
    // Add listener
    mediaQueryListener.addListener(watchMediaQueryFunction)
</script>